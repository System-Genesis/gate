{
  "rules": {
    "filters": {
      "entity": [
        {
          "name": "hideSensitivePersons",
          "field": "hierarchy",
          "values": ["root/sensitive", "granpa/son"]
        },
        {
          "name": "sourceFilter",
          "field": "source",
          "values": ["city_name"]
        }
      ],
      "group": [
        {
          "name": "hideSensitivePersons",
          "field": "source",
          "values": ["root/sensitive", "granpa/son"]
        }
      ],
      "digitalIdentity": [],
      "role": [],
      "organizationGroup": []
    },
    "transformers": {
      "entity": [
        {
          "name": "removeSensitiveDIs",
          "method": "arrayFilter",
          "targetField": "digitalIdentities",
          "conditions": [
            {
              "method": "simpleValueCondition",
              "field": "source",
              "value": "sf_name"
            }
          ]
        },
        {
          "name": "removeFullClearance",
          "method": "fieldExclude",
          "targetField": "fullClearance"
        },
        {
          "name": "removeHierarchy",
          "method": "fieldExclude",
          "targetField": "hierarchy",
          "conditions": [
            {
              "method": "simpleValueCondition",
              "field": "firstName",
              "value": "Myrony"
            }
          ]
        },
        {
          "name": "removeSensitive443DomainUsersHierarchy",
          "method": "arrayMapper",
          "targetField": "digitalIdentities",
          "transformer": {
            "method": "fieldExclude",
            "targetField": "hierarchy",
            "conditions": [
              {
                "method": "simpleValueCondition",
                "field": "source",
                "value": "sf_name"
              }
            ]
          }
        },
        {
          "name": "removeSensitive2Hierarchy",
          "method": "fieldExclude",
          "targetField": "hierarchy",
          "conditions": [
            {
              "method": "hierarchyCondition",
              "field": "hierarchy",
              "value": "root/sensitive2"
            }
          ]
        },
        {
          "name": "removeSensitive2DirectGroup",
          "method": "fieldExclude",
          "targetField": "directGroup",
          "conditions": [
            {
              "method": "hierarchyCondition",
              "field": "hierarchy",
              "value": "root/sensitive2"
            }
          ]
        },
        {
          "name": "removeJob",
          "method": "fieldExclude",
          "targetField": "jobTitle",
          "conditions": [
            {
              "method": "startsWithCondition",
              "field": "hierarchy",
              "value": "es_name"
            }
          ]
        },
        {
          "name": "removeSex",
          "method": "fieldExclude",
          "targetField": "sex"
        },
        {
          "name": "removeSex",
          "method": "fieldExclude",
          "targetField": "sex",
          "conditions": [
            {
              "method": "startsWithCondition",
              "field": "hierarchy",
              "value": "es_name"
            }
          ]
        }
      ],
      "group": [],
      "digitalIdentity": [
        {
          "name": "removeEntityId",
          "method": "fieldExclude",
          "targetField": "entityId",
          "conditions": [
            {
              "method": "simpleValueCondition",
              "field": "source",
              "value": "city_name"
            }
          ]
        },
        {
          "name": "removeUpn",
          "method": "fieldExclude",
          "targetField": "upn"
        }
      ],
      "role": [
        {
          "name": "jobTitle",
          "method": "fieldExclude",
          "targetField": "jobTitle",
          "conditions": [
            {
              "method": "startsWithCondition",
              "field": "hierarchy",
              "value": "wallmart"
            }
          ]
        }
      ],
      "organizationGroup": []
    }
  },
  "scopes": {
    "externalScope": { "rules": ["removeSensitive2DirectGroup"], "undoes": [""] },
    "externalEnaaref": { "rules": ["anotherRule"], "undoes": ["removeSex"] },
    "a": { "rules": ["removeSex"], "undoes": [""] },
    "b": { "rules": ["removeSensitive2Hierarchy"], "undoes": [""] },
    "c": { "rules": ["removeSensitive2DomainUsersHierarchy"], "undoes": [""] },
    "d": { "rules": ["removeSensitiveDomainUsers"], "undoes": [""] },
    "e": { "rules": ["removeSensitive2DirectGroup"], "undoes": [""] },
    "f": { "rules": ["removeJob"], "undoes": [""] },
    "undo_a": { "rules": [""], "undoes": ["removeSex"] },
    "undo_a_add_b": { "rules": ["removeSensitive2Hierarchy"], "undoes": ["removeSex"] },
    "f.a": { "rules": ["hideSensitivePersons"], "undoes": [""] },
    "f.b": { "rules": ["sourceFilter"], "undoes": [""] },
    "f.undo_a": { "rules": [""], "undoes": ["hideSensitivePersons"] },
    "f.undo_a_add_b": { "rules": ["sourceFilter"], "undoes": ["hideSensitivePersons"] },
    "read": {
      "rules": ["removeFullClearance", "removeUpn"],
      "undoes": [""]
    },
    "lego": {
      "undoes": ["removeFullClearance"],
      "rules": [""]
    },
    "remove_upn_from_di": {
      "rules": ["removeUpn"],
      "undoes": [""]
    },
    "remove_fullClearance_undoes_upn": {
      "rules": ["removeFullClearance"],
      "undoes": ["removeUpn"]
    },
    "remove_di_sf": {
      "rules": ["removeSensitiveDIs"],
      "undoes": [""]
    }
  }
}
